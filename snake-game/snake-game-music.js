const bgm = tune`
166.66666666666666: C5-200 + C2/230,
166.66666666666666,
166.66666666666666: C2/230,
166.66666666666666,
166.66666666666666: F5-200,
166.66666666666666: G5-200 + C2/230,
166.66666666666666,
166.66666666666666: E5-200 + F2/230,
166.66666666666666,
166.66666666666666: F2/230,
166.66666666666666: F5-200,
166.66666666666666: F2/230,
166.66666666666666: E5-200 + C2/230,
166.66666666666666: C5-200 + F2/230,
166.66666666666666: D2/230,
166.66666666666666: G4-200,
166.66666666666666: D2/230,
166.66666666666666,
166.66666666666666: G#4-200 + D2/230,
166.66666666666666,
166.66666666666666: A4-200,
166.66666666666666: C5-200 + A2/230,
166.66666666666666,
166.66666666666666: E5-200 + G2/230,
166.66666666666666,
166.66666666666666: F5-200 + G2/230,
166.66666666666666: E5-200,
166.66666666666666: C5-200 + D2/230,
166.66666666666666: G4-200,
166.66666666666666: F4-200 + D2/230,
166.66666666666666: E4-200 + D2/230,
166.66666666666666: G4-200 + G2/230`;

const win = tune`
178.57142857142858: C5-178.57142857142858 + E5^178.57142857142858 + F4/178.57142857142858,
178.57142857142858: F4-178.57142857142858 + C5^178.57142857142858 + D4/178.57142857142858,
178.57142857142858: G4-178.57142857142858 + D5^178.57142857142858 + E4/178.57142857142858,
178.57142857142858: D5-178.57142857142858 + C4/178.57142857142858 + G4/178.57142857142858 + G5^178.57142857142858,
`;

const p1apple = tune`
138.88888888888889: D6/180,
138.88888888888889: G5/180,
138.88888888888889: A5/180,
138.88888888888889: D6/180,
3888.8888888888887`;
const p2apple = tune`
138.88888888888889: A5/180,
138.88888888888889: D6/180,
138.88888888888889: G5/180,
138.88888888888889: A5/180,
3888.8888888888887`;

let playback = playTune(bgm, Infinity);

onInput("d", () => {
  playTune(p1apple);
});

onInput("a", () => {
  playTune(p2apple);
});

onInput("w", () => {
  playback.end();
  playTune(win);
  setTimeout(() => {
    playback = playTune(bgm, Infinity);
  }, "1800");
});
console.log(playback);